#!/bin/bash

# File: apiAutomation-0x00
# Directory: Advanced_shell
# Purpose: Fetch Pikachu data from PokÃ©mon API and handle errors

# API endpoint for Pikachu
URL="https://pokeapi.co/api/v2/pokemon/pikachu"

# Output files
DATA_FILE="data.json"
ERROR_FILE="errors.txt"

# Make API request using curl and save response
curl -s -o "$DATA_FILE" "$URL" 2> "$ERROR_FILE"

# Check if request was successful
if [ $? -eq 0 ]; then
    # Verify if data.json is not empty and contains valid JSON
    if [ -s "$DATA_FILE" ] && jq . "$DATA_FILE" > /dev/null 2>&1; then
        echo "Successfully fetched Pikachu data and saved to $DATA_FILE"
    else
        echo "Error: Invalid or empty JSON response" >> "$ERROR_FILE"
        rm -f "$DATA_FILE"  # Remove invalid file
    fi
else
    echo "Failed to fetch data from $URL" >> "$ERROR_FILE"
    rm -f "$DATA_FILE"  # Remove file if request failed
fi